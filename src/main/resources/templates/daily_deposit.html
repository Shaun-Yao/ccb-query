<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Hello, Bootstrap Table!</title>

    <link rel="stylesheet" href="/webjars/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="/webjars/bootstrap-table/dist/bootstrap-table.min.css">
    <link rel="stylesheet" href="/webjars/weui/1.1.2/dist/style/weui.min.css" />
</head>
<body>
    <table id="table" class="modal-body"></table>
    <div id="deposit" >
        <button type="button" class="btn btn-success" id="add">新增</button>
        <button type="button" class="btn btn-danger" id="remove">删除</button>
    </div>

<script src="/webjars/jquery/3.1.1/jquery.min.js"></script><script src="/webjars/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/webjars/jquery-form/4.2.2/jquery.form.min.js"></script>
<script src="/webjars/bootstrap-table/dist/bootstrap-table.min.js"></script>
<script src="/webjars/bootstrap-table/dist/locale/bootstrap-table-zh-CN.min.js"></script>
<script src="/webjars/bootbox.js/5.1.3/dist/bootbox.min.js"></script>
<script src="/webjars/bootstrap-table/dist/extensions/export/bootstrap-table-export.min.js"></script>
</body>
<script th:inline="javascript">
    $('#table').bootstrapTable({
        url: '/daily-deposit/list',
        pagination: true,
        sidePagination: "server",
        locale: 'zh-CN',
        // search: true,
        showButtonText: true,
        // searchOnEnterKey: true,
        // showSearchButton: true,
        // showSearchClearButton: true,
        // showRefresh: true,
        toolbar: "#deposit",
        clickToSelect: true,
        sortable: true,
        smartDisplay: false,
        pageNumber: 1,     //初始化加载第一页，默认第一页
        pageSize: 10,      //每页的记录行数（*）
        queryParams: function (params) {
            //导出全部数据没有传limit给后台, 把limit设置为全部数据
            if (typeof(params.limit) == "undefined") {
                params.limit = this.totalRows;
            }
            return params;
        },
        onClickRow: function (row, $element) {
            //console.log(row.id);
        },
        onDblClickRow: function (row, $element) {
            $.ajax({
                type: "GET",
                url: "/daily-deposit/get?id=" + row.id,
                async: false,
                success: function(data){

                    $gallery.fadeOut(100);//关闭图片预览
                    //console.log($("#arrivedPickUpStation option:contains('" + data.arrivedPickUpStation + "')").val());
                    $('#form').clearForm();
                    $('#id').val(data.id);
                    $('#userId').val(data.userId);
                    $('#arrivedNum').val(data.arrivedNum);
                    $('#arrivedTime').val(data.arrivedTime);
                    $('#leavedNum').val(data.leavedNum);
                    $('#leavedTime').val(data.leavedTime);
                    //根据自定义属性值选中
                    $("input:radio[name=arrivedTravelMode][arrivedTravelMode=" + data.arrivedTravelMode + "]")[0].checked=true;
                    $("#arrivedPickUpStation option:contains('" + data.arrivedPickUpStation + "')")[0].selected=true;
                    $("input:radio[name=leavedTravelMode][leavedTravelMode=" + data.leavedTravelMode + "]")[0].checked=true;
                    $("#leavedPickUpLocation option:contains('" + data.leavedPickUpLocation + "')")[0].selected=true;
                    $("#leavedStation option:contains('" + data.leavedStation + "')")[0].selected=true;

                    $uploaderFiles.empty();
                    pictureSize = 0;
                    if (data.picture1 != null && data.picture1 != '') {
                        $uploaderFiles.append($(tmpl.replace('#url#', "/schedule/show?fileName=" + data.picture1)).attr('file-name', data.picture1));
                        pictureSize = pictureSize + 1;
                    }

                    if (data.picture2 != null && data.picture2 != '') {
                        $uploaderFiles.append($(tmpl.replace('#url#', "/schedule/show?fileName=" + data.picture2)).attr('file-name', data.picture2));
                        pictureSize = pictureSize + 1;
                        //$(".weui-uploader__input-box").hide();
                    }
                    checkPhotoSize();

                }
            });
            $('#myModal').modal('show');
        },
        columns: [ {
            field: '',
            checkbox: true, // 显示一个勾选框
            align: 'center', // 居中显示

            formatter: function (value, row, index) {
                return row.id;
            }
        },{
            field: 'id',
            title: 'ID',
            visible: false
        }, {
            field: 'date',
            title: '营业日期'
        }, {
            field: 'amount',
            title: '营业额'
        }, {
            field: 'bank',
            title: '营业额'
        }, {
            field: 'depositDate',
            title: '存款日期'
        }, {
            field: 'deposit',
            title: '存款额'
        }]
    });
</script>
</html>